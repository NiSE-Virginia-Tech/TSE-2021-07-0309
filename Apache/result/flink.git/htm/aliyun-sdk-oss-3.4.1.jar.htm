<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>SpotBugs Report</title>
<style type="text/css">
		.tablerow0 {
			background: #EEEEEE;
		}

		.tablerow1 {
			background: white;
		}

		.detailrow0 {
			background: #EEEEEE;
		}

		.detailrow1 {
			background: white;
		}

		.tableheader {
			background: #b9b9fe;
			font-size: larger;
		}

		.tablerow0:hover, .tablerow1:hover {
			background: #aaffaa;
		}

		.priority-1 {
		    color: red;
		    font-weight: bold;
		}
		.priority-2 {
		    color: orange;
		    font-weight: bold;
		}
		.priority-3 {
		    color: green;
		    font-weight: bold;
		}
		.priority-4 {
		    color: blue;
		    font-weight: bold;
		}
		</style>
<script type="text/javascript">
			function toggleRow(elid) {
				if (document.getElementById) {
					element = document.getElementById(elid);
					if (element) {
						if (element.style.display == 'none') {
							element.style.display = 'block';
							//window.status = 'Toggle on!';
						} else {
							element.style.display = 'none';
							//window.status = 'Toggle off!';
						}
					}
				}
			}
		</script>
</head>
<body>
<h1>
<a href="https://spotbugs.github.io/">SpotBugs</a> Report</h1>
<h2>Project Information</h2>
<p>Project: 
		</p>
<p>SpotBugs version: 3.1.12</p>
<p>Code analyzed:</p>
<ul>
<li>/home/x/CryptoAPIDetect/dataset/group/flink.git/aliyun-sdk-oss-3.4.1.jar</li>
</ul>
<p>
<br/>
<br/>
</p>
<h2>Metrics</h2>
<p>15983 lines of code analyzed,
	in 401 classes, 
	in 10 packages.</p>
<table width="500" cellpadding="5" cellspacing="2">
<tr class="tableheader">
<th align="left">Metric</th>
<th align="right">Total</th>
<th align="right">Density*</th>
</tr>
<tr class="tablerow0">
<td>High Priority Warnings</td>
<td align="right">3</td>
<td align="right">0.19</td>
</tr>
<tr class="tablerow1">
<td>Medium Priority Warnings</td>
<td align="right">21</td>
<td align="right">1.31</td>
</tr>
<tr class="$totalClass">
<td>
<b>Total Warnings</b>
</td>
<td align="right">
<b>24</b>
</td>
<td align="right">
<b>1.50</b>
</td>
</tr>
</table>
<p>
<i>(* Defects per Thousand lines of non-commenting source statements)</i>
</p>
<p>
<br/>
<br/>
</p>
<h2>Contents</h2>
<ul>
<li>
<a href="#Warnings_SECURITY">Security Warnings</a>
</li>
<li>
<a href="#Details">Details</a>
</li>
</ul>
<h1>Summary</h1>
<table width="500" cellpadding="5" cellspacing="2">
<tr class="tableheader">
<th align="left">Warning Type</th>
<th align="right">Number</th>
</tr>
<tr class="tablerow0">
<td>
<a href="#Warnings_SECURITY">Security Warnings</a>
</td>
<td align="right">24</td>
</tr>
<tr class="tablerow1">
<td>
<b>Total</b>
</td>
<td align="right">
<b>24</b>
</td>
</tr>
</table>
<h1>Warnings</h1>
<p>Click on a warning row to see full context information.</p>
<h2>
<a name="Warnings_SECURITY">Security Warnings</a>
</h2>
<table class="warningtable" width="100%" cellspacing="0">
<tr class="tableheader">
<th align="left">Code</th>
<th align="left">Warning</th>
</tr>
<tr class="tablerow1" onclick="toggleRow('N65838');">
<td>
<span class="priority-2">SECHPP</span>
</td>
<td>Concatenating user-controlled input into a URL</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N65838" style="display: none;">
<a href="#HTTP_PARAMETER_POLLUTION">Bug type HTTP_PARAMETER_POLLUTION (click for details)</a>
<br/>In class com.aliyun.oss.common.comm.HttpRequestFactory<br/>In method com.aliyun.oss.common.comm.HttpRequestFactory.createHttpRequest(ServiceClient$Request, ExecutionContext)<br/>At HttpRequestFactory.java:[line 67]<br/>Sink method org/apache/http/client/methods/HttpGet.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/comm/ServiceClient$Request.getUri()Ljava/lang/String;<br/>Unknown source com/aliyun/oss/common/comm/ServiceClient$Request.uri<br/>At HttpRequestFactory.java:[line 42]<br/>At ServiceClient.java:[line 332]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N66079');">
<td>
<span class="priority-1">SECMD5</span>
</td>
<td>This API MD5 (MDX) is not a recommended cryptographic hash function</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N66079" style="display: none;">
<a href="#WEAK_MESSAGE_DIGEST_MD5">Bug type WEAK_MESSAGE_DIGEST_MD5 (click for details)</a>
<br/>In class com.aliyun.oss.common.utils.BinaryUtil<br/>In method com.aliyun.oss.common.utils.BinaryUtil.calculateMd5(byte[])<br/>At BinaryUtil.java:[line 43]<br/>Value MD5</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66661');">
<td>
<span class="priority-1">SECOBDES</span>
</td>
<td>Object deserialization is used in com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint.load(String)</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66661" style="display: none;">
<a href="#OBJECT_DESERIALIZATION">Bug type OBJECT_DESERIALIZATION (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint<br/>In method com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint.load(String)<br/>At OSSDownloadOperation.java:[line 83]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N67254');">
<td>
<span class="priority-1">SECOBDES</span>
</td>
<td>Object deserialization is used in com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint.load(String)</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N67254" style="display: none;">
<a href="#OBJECT_DESERIALIZATION">Bug type OBJECT_DESERIALIZATION (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint<br/>In method com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint.load(String)<br/>At OSSUploadOperation.java:[line 80]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N65635');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N65635" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.common.auth.ProfileConfigFile<br/>In method new com.aliyun.oss.common.auth.ProfileConfigFile(String)<br/>At ProfileConfigFile.java:[line 62]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/auth/ProfileConfigFile.validateFilePath(Ljava/lang/String;)Ljava/lang/String;<br/>Unknown source com/aliyun/oss/common/auth/ProfileConfigFile.&lt;init&gt;(Ljava/lang/String;)V parameter 0<br/>Unknown source com/aliyun/oss/common/auth/ProfileConfigFile.validateFilePath(Ljava/lang/String;)Ljava/lang/String; parameter 0<br/>At ProfileConfigFile.java:[line 62]<br/>At ProfileCredentialsProvider.java:[line 119]<br/>At ProfileCredentialsProvider.java:[line 156]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N65744');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N65744" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.common.auth.ProfileConfigFile<br/>In method new com.aliyun.oss.common.auth.ProfileConfigFile(String, ProfileConfigLoader)<br/>At ProfileConfigFile.java:[line 70]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/auth/ProfileConfigFile.validateFilePath(Ljava/lang/String;)Ljava/lang/String;<br/>Unknown source com/aliyun/oss/common/auth/ProfileConfigFile.validateFilePath(Ljava/lang/String;)Ljava/lang/String; parameter 0<br/>Unknown source com/aliyun/oss/common/auth/ProfileConfigFile.&lt;init&gt;(Ljava/lang/String;Lcom/aliyun/oss/common/auth/ProfileConfigLoader;)V parameter 1<br/>Method usage not detected<br/>At ProfileConfigFile.java:[line 70]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N65931');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N65931" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.common.utils.AuthUtils<br/>In method com.aliyun.oss.common.utils.AuthUtils.loadPrivateKeyFromFile(String)<br/>At AuthUtils.java:[line 272]<br/>Sink method java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/utils/AuthUtils.loadPrivateKeyFromFile(Ljava/lang/String;)Ljava/lang/String; parameter 0<br/>Method usage not detected</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N66005');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N66005" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.common.utils.AuthUtils<br/>In method com.aliyun.oss.common.utils.AuthUtils.loadPublicKeyFromFile(String)<br/>At AuthUtils.java:[line 240]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/utils/AuthUtils.loadPublicKeyFromFile(Ljava/lang/String;)Ljava/lang/String; parameter 0<br/>Method usage not detected</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66137');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66137" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.common.utils.IniEditor<br/>In method com.aliyun.oss.common.utils.IniEditor.load(String)<br/>At IniEditor.java:[line 566]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/utils/IniEditor.load(Ljava/lang/String;)V parameter 0<br/>Method usage not detected</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N66211');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N66211" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.common.utils.IniEditor<br/>In method com.aliyun.oss.common.utils.IniEditor.save(String)<br/>At IniEditor.java:[line 506]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/common/utils/IniEditor.save(Ljava/lang/String;)V parameter 0<br/>Method usage not detected</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66285');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66285" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation<br/>In method com.aliyun.oss.internal.OSSDownloadOperation.createFixedFile(String, long)<br/>At OSSDownloadOperation.java:[line 442]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSDownloadOperation.createFixedFile(Ljava/lang/String;J)V parameter 2<br/>At OSSDownloadOperation.java:[line 438]<br/>At DownloadFileRequest.java:[line 78]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N66374');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N66374" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation<br/>In method com.aliyun.oss.internal.OSSDownloadOperation.remove(String)<br/>At OSSDownloadOperation.java:[line 653]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSDownloadOperation.remove(Ljava/lang/String;)Z parameter 0<br/>At OSSDownloadOperation.java:[line 369]<br/>At OSSDownloadOperation.java:[line 375]<br/>At OSSDownloadOperation.java:[line 420]<br/>At DownloadFileRequest.java:[line 94]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66483');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66483" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation<br/>In method com.aliyun.oss.internal.OSSDownloadOperation.renameTo(String, String)<br/>At OSSDownloadOperation.java:[line 663]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSDownloadOperation.renameTo(Ljava/lang/String;Ljava/lang/String;)V parameter 1<br/>At OSSDownloadOperation.java:[line 415]<br/>At DownloadFileRequest.java:[line 78]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N66572');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N66572" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation<br/>In method com.aliyun.oss.internal.OSSDownloadOperation.renameTo(String, String)<br/>At OSSDownloadOperation.java:[line 664]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSDownloadOperation.renameTo(Ljava/lang/String;Ljava/lang/String;)V parameter 0<br/>At OSSDownloadOperation.java:[line 415]<br/>At DownloadFileRequest.java:[line 74]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66715');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66715" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint<br/>In method com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint.load(String)<br/>At OSSDownloadOperation.java:[line 81]<br/>Sink method java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSDownloadOperation$DownloadCheckPoint.load(Ljava/lang/String;)V parameter 0<br/>At OSSDownloadOperation.java:[line 367]<br/>At DownloadFileRequest.java:[line 94]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N66893');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/RandomAccessFile.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N66893" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation$Task<br/>In method com.aliyun.oss.internal.OSSDownloadOperation$Task.call()<br/>At OSSDownloadOperation.java:[line 557]<br/>Sink method java/io/RandomAccessFile.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V<br/>Sink parameter 1<br/>Unknown source com/aliyun/oss/model/DownloadFileRequest.downloadFile<br/>Unknown source com/aliyun/oss/model/DownloadFileRequest.getTempDownloadFile()Ljava/lang/String;<br/>At OSSDownloadOperation.java:[line 557]<br/>At DownloadFileRequest.java:[line 78]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66987');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66987" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation<br/>In method com.aliyun.oss.internal.OSSUploadOperation.remove(String)<br/>At OSSUploadOperation.java:[line 590]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSUploadOperation.remove(Ljava/lang/String;)Z parameter 0<br/>At OSSUploadOperation.java:[line 330]<br/>At OSSUploadOperation.java:[line 336]<br/>At OSSUploadOperation.java:[line 377]<br/>At UploadFileRequest.java:[line 101]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N67096');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N67096" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation$FileStat<br/>In method com.aliyun.oss.internal.OSSUploadOperation$FileStat.getFileStat(String)<br/>At OSSUploadOperation.java:[line 186]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSUploadOperation$FileStat.getFileStat(Ljava/lang/String;)Lcom/aliyun/oss/internal/OSSUploadOperation$FileStat; parameter 0<br/>At OSSUploadOperation.java:[line 399]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N67175');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N67175" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation$Task<br/>In method com.aliyun.oss.internal.OSSUploadOperation$Task.call()<br/>At OSSUploadOperation.java:[line 496]<br/>Sink method java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSUploadOperation$UploadCheckPoint.uploadFile<br/>At OSSUploadOperation.java:[line 496]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N67308');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N67308" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint<br/>In method com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint.isValid(String)<br/>At OSSUploadOperation.java:[line 119]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSUploadOperation$UploadCheckPoint.isValid(Ljava/lang/String;)Z parameter 0<br/>At OSSUploadOperation.java:[line 334]<br/>At UploadFileRequest.java:[line 85]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N67397');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N67397" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint<br/>In method com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint.load(String)<br/>At OSSUploadOperation.java:[line 78]<br/>Sink method java/io/FileInputStream.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSUploadOperation$UploadCheckPoint.load(Ljava/lang/String;)V parameter 0<br/>At OSSUploadOperation.java:[line 328]<br/>At UploadFileRequest.java:[line 101]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N65551');">
<td>
<span class="priority-2">SECPTI</span>
</td>
<td>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;)V) reads a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N65551" style="display: none;">
<a href="#PATH_TRAVERSAL_IN">Bug type PATH_TRAVERSAL_IN (click for details)</a>
<br/>In class com.aliyun.oss.OSSClient<br/>In method com.aliyun.oss.OSSClient.putObject(URL, String, Map, boolean)<br/>At OSSClient.java:[line 486]<br/>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/OSSClient.putObject(Ljava/net/URL;Ljava/lang/String;Ljava/util/Map;Z)Lcom/aliyun/oss/model/PutObjectResult; parameter 2<br/>Method usage not detected<br/>At OSSClient.java:[line 477]</p>
</td>
</tr>
<tr class="tablerow1" onclick="toggleRow('N66804');">
<td>
<span class="priority-2">SECPTO</span>
</td>
<td>This API (java/io/FileOutputStream.&lt;init&gt;(Ljava/lang/String;)V) writes to a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow1">
<td/>
<td>
<p id="N66804" style="display: none;">
<a href="#PATH_TRAVERSAL_OUT">Bug type PATH_TRAVERSAL_OUT (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint<br/>In method com.aliyun.oss.internal.OSSDownloadOperation$DownloadCheckPoint.dump(String)<br/>At OSSDownloadOperation.java:[line 94]<br/>Sink method java/io/FileOutputStream.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSDownloadOperation$DownloadCheckPoint.dump(Ljava/lang/String;)V parameter 0<br/>At OSSDownloadOperation.java:[line 589]<br/>At DownloadFileRequest.java:[line 94]</p>
</td>
</tr>
<tr class="tablerow0" onclick="toggleRow('N67486');">
<td>
<span class="priority-2">SECPTO</span>
</td>
<td>This API (java/io/FileOutputStream.&lt;init&gt;(Ljava/lang/String;)V) writes to a file whose location might be specified by user input</td>
</tr>
<tr class="detailrow0">
<td/>
<td>
<p id="N67486" style="display: none;">
<a href="#PATH_TRAVERSAL_OUT">Bug type PATH_TRAVERSAL_OUT (click for details)</a>
<br/>In class com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint<br/>In method com.aliyun.oss.internal.OSSUploadOperation$UploadCheckPoint.dump(String)<br/>At OSSUploadOperation.java:[line 91]<br/>Sink method java/io/FileOutputStream.&lt;init&gt;(Ljava/lang/String;)V<br/>Sink parameter 0<br/>Unknown source com/aliyun/oss/internal/OSSUploadOperation$UploadCheckPoint.dump(Ljava/lang/String;)V parameter 0<br/>At OSSUploadOperation.java:[line 518]<br/>At UploadFileRequest.java:[line 101]</p>
</td>
</tr>
</table>
<h1>
<a name="Details">Details</a>
</h1>
<h2>
<a name="HTTP_PARAMETER_POLLUTION">HTTP_PARAMETER_POLLUTION: HTTP Parameter Pollution</a>
</h2>
            
<p>
Concatenating unvalidated user input into a URL can allow an attacker to override the value of a request parameter. Attacker may be able to override existing parameter values, inject a new parameter or exploit variables out of a direct reach. HTTP Parameter Pollution (HPP) attacks consist of injecting encoded query string delimiters into other existing parameters. If a web application does not properly sanitize the user input, a malicious user may compromise the logic of the application to perform either client-side or server-side attacks.<br/>
In the following example the programmer has not considered the possibility that an attacker could provide a parameter <code>lang</code> such as <code>en&user_id=1</code>, which would enable him to change the <code>user_id</code> at will.
</p>
<p>
    <b>Vulnerable Code:</b><br/>
<pre>String lang = request.getParameter("lang");
GetMethod get = new GetMethod("http://www.host.com");
get.setQueryString("lang=" + lang + "&user_id=" + user_id);
get.execute();</pre>
<p>
    <b>Solution:</b><br/>
Sanitize user input before using it in HTTP parameters.
</p>
<br/>
<p>
<b>References</b><br/>
<a href="https://capec.mitre.org/data/definitions/460.html">CAPEC-460: HTTP Parameter Pollution (HPP)</a>
</p>
            
        
<h2>
<a name="WEAK_MESSAGE_DIGEST_MD5">WEAK_MESSAGE_DIGEST_MD5: MD2, MD4 and MD5 are weak hash functions</a>
</h2>
            
<p>The algorithms MD2, MD4 and MD5 are not a recommended MessageDigest. <b>PBKDF2</b> should be used to hash password for example.</p>

<blockquote>
    "The security of the MD5 hash function is severely compromised. A collision attack exists that can find collisions
    within seconds on a computer with a 2.6 GHz Pentium 4 processor (complexity of 2<sup>24.1</sup>).[1] Further, there is also a
    chosen-prefix collision attack that can produce a collision for two inputs with specified prefixes within hours, using
    off-the-shelf computing hardware (complexity 2<sup>39</sup>).[2]"<br/>
    - <a href="https://en.wikipedia.org/wiki/MD5#Security">Wikipedia: MD5 - Security</a>
</blockquote>

<blockquote>
    "<b>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, and SHA-512/256</b>:<br/>
    The use of these hash functions is acceptable for all hash function applications."<br/>
    - <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST: Transitioning the Use of Cryptographic Algorithms and Key Lengths p.15</a>
</blockquote>
<blockquote>
    "The main idea of a PBKDF is to slow dictionary or brute force attacks on the passwords by increasing the time
    needed to test each password. An attacker with a list of likely passwords can evaluate the PBKDF using the known
    iteration counter and the salt. Since an attacker has to spend a significant amount of computing time for each try,
    it becomes harder to apply the dictionary or brute force attacks."<br/>
- <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf">NIST: Recommendation for Password-Based Key Derivation  p.12</a>
</blockquote>
<br/>
<p>
    <b>Vulnerable Code:</b><br/>
    <pre>MessageDigest md5Digest = MessageDigest.getInstance("MD5");
    md5Digest.update(password.getBytes());
    byte[] hashValue = md5Digest.digest();</pre>
    <br/>
    <pre>byte[] hashValue = DigestUtils.getMd5Digest().digest(password.getBytes());</pre>
</p>
<br/>
<p>
    <b>Solution (Using bouncy castle):</b><br/>
    <pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    PKCS5S2ParametersGenerator gen = new PKCS5S2ParametersGenerator(new SHA256Digest());
    gen.init(password.getBytes("UTF-8"), salt.getBytes(), 4096);
    return ((KeyParameter) gen.generateDerivedParameters(256)).getKey();
}</pre>
    <br/>
    <b>Solution (Java 8 and later):</b><br/>
    <pre>public static byte[] getEncryptedPassword(String password, byte[] salt) throws NoSuchAlgorithmException, InvalidKeySpecException {
    KeySpec spec = new PBEKeySpec(password.toCharArray(), salt, 4096, 256 * 8);
    SecretKeyFactory f = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
    return f.generateSecret(spec).getEncoded();
}</pre>
</p>
<br/>
<p>
<b>References</b><br/>
[1] <a href="https://www.win.tue.nl/hashclash/On%20Collisions%20for%20MD5%20-%20M.M.J.%20Stevens.pdf">On Collisions for MD5</a>: Master Thesis by M.M.J. Stevens<br/>
[2] <a href="https://homepages.cwi.nl/~stevens/papers/stJOC%20-%20Chosen-Prefix%20Collisions%20for%20MD5%20and%20Applications.pdf">Chosen-prefix collisions for MD5 and applications</a>: Paper written by Marc Stevens<br/>
<a href="https://en.wikipedia.org/wiki/MD5">Wikipedia: MD5</a><br/>
<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST: Transitioning the Use of Cryptographic Algorithms and Key Lengths</a><br/>
<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf">NIST: Recommendation for Password-Based Key Derivation</a><br/>
<a href="https://stackoverflow.com/q/22580853/89769">Stackoverflow: Reliable implementation of PBKDF2-HMAC-SHA256 for Java</a><br/>
<a href="https://cwe.mitre.org/data/definitions/327.html">CWE-327: Use of a Broken or Risky Cryptographic Algorithm</a>
</p>

        
<h2>
<a name="OBJECT_DESERIALIZATION">OBJECT_DESERIALIZATION: Object deserialization is used in {1}</a>
</h2>
            
<p>
    Object deserialization of untrusted data can lead to remote code execution, if there is a class in classpath that allows
    the trigger of malicious operation.
</p>
<p>
    Libraries developers tend to fix class that provided potential malicious trigger. There are still classes that are
    known to trigger Denial of Service<sup>[1]</sup>.
</p>
<p>
    Deserialization is a sensible operation that has a great history of vulnerabilities. The web application might
    become vulnerable as soon as a new vulnerability is found in the Java Virtual Machine<sup>[2] [3]</sup>.
</p>

<p>
<b>Code at risk:</b><br/>
<pre>
public UserData deserializeObject(InputStream receivedFile) throws IOException, ClassNotFoundException {

    try (ObjectInputStream in = new ObjectInputStream(receivedFile)) {
        return (UserData) in.readObject();
    }
}
</pre>
</p>

<p>
<b>Solutions:</b><br/>
<p>
Avoid deserializing object provided by remote users.
</p>
<br/>
<p>
<b>References</b><br/>
<a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502: Deserialization of Untrusted Data</a><br/>
<a href="https://www.owasp.org/index.php/Deserialization_of_untrusted_data">Deserialization of untrusted data</a><br/>
<a href="https://www.oracle.com/technetwork/java/seccodeguide-139067.html#8">Serialization and Deserialization </a><br/>
<a href="https://github.com/frohoff/ysoserial">A tool for generating payloads that exploit unsafe Java object deserialization</a><br/>
[1] <a href="https://gist.github.com/coekie/a27cc406fc9f3dc7a70d">Example of Denial of Service using the class <code>java.util.HashSet</code></a><br/>
[2] <a href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2590">OpenJDK: Deserialization issue in ObjectInputStream.readSerialData() (CVE-2015-2590)</a><br/>
[3] <a href="https://www.rapid7.com/db/modules/exploit/multi/browser/java_calendar_deserialize">Rapid7: Sun Java Calendar Deserialization Privilege Escalation (CVE-2008-5353)</a>
</p>

        
<h2>
<a name="PATH_TRAVERSAL_IN">PATH_TRAVERSAL_IN: Potential Path Traversal (file read)</a>
</h2>
            
<p>A file is opened to read its content. The filename comes from an <b>input</b> parameter.
If an unfiltered parameter is passed to this file API, files from an arbitrary filesystem location could be read.</p>
<p>This rule identifies <b>potential</b> path traversal vulnerabilities. In many cases, the constructed file path cannot be controlled
by the user. If that is the case, the reported instance is a false positive.</p>
<br/>

<p>
    <b>Vulnerable Code:</b><br/>
<pre>@GET
@Path("/images/{image}")
@Produces("images/*")
public Response getImage(@javax.ws.rs.PathParam("image") String image) {
    File file = new File("resources/images/", image); //Weak point

    if (!file.exists()) {
        return Response.status(Status.NOT_FOUND).build();
    }

    return Response.ok().entity(new FileInputStream(file)).build();
}</pre>
</p>
<br/>

<p>
    <b>Solution:</b><br/>
<pre>import org.apache.commons.io.FilenameUtils;

@GET
@Path("/images/{image}")
@Produces("images/*")
public Response getImage(@javax.ws.rs.PathParam("image") String image) {
    File file = new File("resources/images/", FilenameUtils.getName(image)); //Fix

    if (!file.exists()) {
        return Response.status(Status.NOT_FOUND).build();
    }

    return Response.ok().entity(new FileInputStream(file)).build();
}</pre>
</p>
<br/>
<p>
<b>References</b><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="https://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a>
</p>

        
<h2>
<a name="PATH_TRAVERSAL_OUT">PATH_TRAVERSAL_OUT: Potential Path Traversal (file write)</a>
</h2>
            
<p>A file is opened to write to its contents. The filename comes from an <b>input</b> parameter.
If an unfiltered parameter is passed to this file API, files at an arbitrary filesystem location could be modified.</p>
<p>This rule identifies <b>potential</b> path traversal vulnerabilities. In many cases, the constructed file path cannot be controlled
by the user. If that is the case, the reported instance is a false positive.</p>
<br/>
<p>
<b>References</b><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC-33: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="https://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a>
</p>

        </body>
</html>
